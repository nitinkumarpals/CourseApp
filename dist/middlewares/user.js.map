{"version":3,"sources":["../../src/middlewares/user.ts"],"sourcesContent":["import jwt, { JwtPayload } from \"jsonwebtoken\";\nimport { Request, Response, NextFunction } from \"express\";\n\nexport const userMiddleware = async (\n  req: Request,\n  res: Response,\n  next: NextFunction\n) => {\n  try {\n    const token = req.headers.authorization?.split(\" \")[1];\n    if (!token) {\n      throw new Error(\"Authorization token is missing or invalid\");\n    }\n    const decoded = jwt.verify(\n      token,\n      process.env.JWT_SECRET || \"\"\n    ) as JwtPayload;\n    if (decoded) {\n      req.userId = decoded.id;\n      next();\n    } else {\n      throw new Error(\"Invalid token payload or jwt secret\");\n    }\n  } catch (error) {\n    res.status(401).json({\n      success: false,\n      message: error instanceof Error ? error.message : \"Unauthorized\",\n    });\n  }\n};\n"],"mappings":";AAAA,OAAO,SAAyB;AAGzB,IAAM,iBAAiB,OAC5B,KACA,KACA,SACG;AACH,MAAI;AACF,UAAM,QAAQ,IAAI,QAAQ,eAAe,MAAM,GAAG,EAAE,CAAC;AACrD,QAAI,CAAC,OAAO;AACV,YAAM,IAAI,MAAM,2CAA2C;AAAA,IAC7D;AACA,UAAM,UAAU,IAAI;AAAA,MAClB;AAAA,MACA,QAAQ,IAAI,cAAc;AAAA,IAC5B;AACA,QAAI,SAAS;AACX,UAAI,SAAS,QAAQ;AACrB,WAAK;AAAA,IACP,OAAO;AACL,YAAM,IAAI,MAAM,qCAAqC;AAAA,IACvD;AAAA,EACF,SAAS,OAAO;AACd,QAAI,OAAO,GAAG,EAAE,KAAK;AAAA,MACnB,SAAS;AAAA,MACT,SAAS,iBAAiB,QAAQ,MAAM,UAAU;AAAA,IACpD,CAAC;AAAA,EACH;AACF;","names":[]}